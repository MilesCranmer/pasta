#mass = grams/mole
#distance = Angstroms
#time = picoseconds
#energy = eV
#velocity = Angstroms/picosecond
#force = eV/Angstrom
#torque = eV
#temperature = Kelvin
#pressure = bars
#dynamic viscosity = Poise
#charge = multiple of electron charge (1.0 is a proton)
#dipole = charge*Angstroms
#electric field = volts/Angstrom
#density = gram/cm^dim

units metal
dimension 3
boundary p p p

atom_style atomic
#extra distance past force cutoff
neighbor	0.3e-5 bin
neigh_modify	delay 5

#pasta spacing is 3.3e-13 angstroms
variable spacing equal 3e-5 #3.22e-5
variable xlo equal 0.0
variable ylo equal 0.0
variable zlo equal 0.0
variable xhi equal 11.0
variable yhi equal 11.0
variable zhi equal 11.0
variable charge equal 1.0
variable mass equal 1.0
#as given in 0508044v1 (chuck's paper)
variable lambda equal 1.25e-10
variable oolambda equal 1.0/${lambda}
variable ootlambda equal 1.0/2.0/${lambda}
variable a equal 110e6
variable bnp equal -50e6
variable bnnpp equal -2e6
variable cpp equal 14.4

variable pi equal 3.141593
variable kb equal 8.6173e-5
variable perm_kb_over_e_square equal 4762.24e10
###############################################################
variable gamma equal 175
###############################################################
lattice bcc ${spacing}
region inthezone block ${xlo} ${xhi} ${ylo} ${yhi} ${zlo} ${zhi}
region fill block 0 10.0 0 10.0 0 10.0
create_box 2 inthezone

mass 1 ${mass}
mass 2 ${mass}

create_atoms 1 region fill

variable xl equal ${xhi}-${xlo}
variable yl equal ${yhi}-${ylo}
variable zl equal ${zhi}-${zlo}
variable volume equal (${spacing})^(3)*${xl}*${yl}*${zl}
variable numatoms equal 2331
variable atomdensity equal ${numatoms}/${volume} #air is about 1e-5
variable ddensity equal ${atomdensity}*(1.67)
variable edensity equal ${charge}*(${atomdensity})
variable radius equal (3/4/${pi}/${atomdensity})^(1.0/3.0)
variable temperature equal 1.16e10 #(${charge})^2/(${radius})/${kb}/${gamma}
variable kappa equal (${edensity}/${perm_kb_over_e_square}/${temperature})^(1/2)
variable cutoff equal 7e-5

print "Total volume of ${volume} angstrom^3"
print "have a density of ${ddensity} g/cm^3"
print "need to get to ${temperature} kelvin for gamma=${gamma}" 
print "kappa set to ${kappa}"
pair_style hybrid/overlay gauss ${cutoff} gauss ${cutoff} yukawa 1e4 ${cutoff}

#make screening length long to test
#for thallium, this is 1.55e-24 Joules * metres
#for hydrogen, get 2.31e-28 J m
#pair_coeff	* * 1 #H^+ with H^+
pair_coeff * * gauss 1 ${a} ${oolambda}
pair_coeff 1 1 gauss 2 ${bnnpp} ${ootlambda}
pair_coeff 1 2 gauss 2 ${bnp} ${ootlambda}
pair_coeff 2 2 gauss 2 ${bnnpp} ${ootlambda}
pair_coeff 1 1 yukawa ${cpp} 
#A_gauss=energy
#A_yukawa=energy*distance, cutoff = distance

group freezer type 1 
#have to take into account density to get radius
#and kappa is inverse debye length
#start as a lattice, see if it stays.
#

#measure temperature + give temperature
compute     new all temp
velocity    all create 0 42424242 temp new

fix		1 all nve
#fix_modify 1 temp new

timestep 5e-14 #*10^-12
thermo		1000
thermo_modify	temp new

#dump		0 all atom 10 dump.friction
dump		1 all image 100 image.*.ppm type type &
		zoom 1.0 adiam 1e-5

velocity    all create 0 42424242 temp new
run		1000
velocity    all create 0 42424242 temp new
run		1000
velocity    all create 0 42424242 temp new
run		1000
velocity    all create 0 42424242 temp new
run		1000
velocity    all create 0 42424242 temp new
run		1000
velocity    all create 0 42424242 temp new
run		1000
velocity    all create 0 42424242 temp new
run		1000
velocity    all create 0 42424242 temp new
run		1000

variable ss loop 20
label loop
velocity    all create ${temperature} 42424242 temp new
run 2000
next ss 
jump in.2.pasta_test loop

compute myRDF all rdf 50
fix 5 all ave/time 100 1 100 c_myRDF file pasta.rdf mode vector
